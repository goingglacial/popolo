<!--
home.html
render home page in browser
-->

<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title>Popolo App</title>
		{% load staticfiles %}
		<link href="{{ STATIC_URL }}homestyle.css" rel="stylesheet" type="text/css"/>
		<link href="{{ STATIC_URL }}bootstrap.css" rel="stylesheet" type="text/css"/>
		<link href="{{ STATIC_URL }}jquery-ui.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="{{ STATIC_URL }}stateNames.js"></script>
		<script type="text/javascript" src="{{ STATIC_URL }}jquery.js"></script>
		<script type="text/javascript" src="{{ STATIC_URL }}jquery-ui.js"></script>
		
		<script>
			$(document).ready(function() {
				$("#cities").autocomplete({ 
					delay: 0,
				      select: function( event, ui ) {
				      	console.log(ui.item);
				        $( "#cities" ).val( ui.item.label );
				        $( "#results" ).html( ui.item.desc );
				 
				        return false;
				      },
				      focus: function( event, ui ) {
				        $( "#results" ).html("");
				        return false;
				      },
					  source: function(request, response) {
						var base = 'search/' + encodeURI($("#cities").val());
						//var base = 'search/'' + $("#cities").val()';
						console.log(base);

							$.ajax({
					            dataType: "json",
					            type : 'Get',
					            url: base,
					            success: function(data) {
					            	// console.log(data);

					            	response(data.map(function(d) {
					            		return {label: (d.city + ", " + d.state), desc: d.pop};//(d.city + ', ' + d.state + ': ' + d.pop);
					            	}));
					          	},
					          	error: function(data) {
					          		console.log("ERROR");
					          	}
					        });
					}
				}).autocomplete( "instance" )._renderItem = function( ul, item ) {

      return $( "<li>" )
        .append( "<a>" + item.label + "<br>" + item.desc + "</a>" )
        .appendTo( ul );
    };
;
			});

		</script>

	</head>

	<body>

		<img id="full-screen-background-image" src="{% static "sf.jpg" %}" alt="citybythebay"/>

 		<ul id="nav">
 			<li><a href="#">States</a></li>
 			<li><a href="{% url 'popolo:random' %}">Random</a></li>
 			<li><a href="{% url 'popolo:results' %}">Results</a></li>
 			<li><a href="{% url 'popolo:bubbles' %}">Bubbles</a></li>
 			<li><a href="{% url 'popolo:about' %}">About</a></li>
 		</ul>

		<h1 id="header">popolo: know where you are</h1>
		<br>

		<center>

			<div class="ui-widget">
				<input id="cities" type="text" placeholder="search u.s. city pops">
				<center>
					<div id="results">
					</div>
				</center>
			</div>

		</center>

		<div id="copyright">
			<p>&copy; Annie Kramer 2014</p>
		</div>

	</body>

</html>